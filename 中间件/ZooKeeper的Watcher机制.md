​	分布式系统从根本上来说就是不同节点上的进程并发执行，并且相互之间对进程的行为进行协调处理的过程。不同节点上的进程互相协调行为的过程叫做分布式同步。许多分布式系统需要一个进程作为任务的协调者，执行一些其他进程并不执行的特殊的操作，一般情况下哪个进程担当任务的协调者都无所谓，但是必须有一个进程作为协调者，自动选举出一个协调者的过程就是分布式选举。ZooKeeper 正是为了解决这一系列问题而生的.

#### ZooKeeper Watcher 事件机制

​	Watcher 监听机制是 Zookeeper 中非常重要的特性，我们 基于 zookeeper 上创建的节点，可以对这些节点绑定监听 事件，比如可以监听节点数据变更、节点删除、子节点状 态变更等事件，通过这个事件机制，可以基于 zookeeper 实现分布式锁、集群管理等功能 。

​	watcher 特性：当数据发生变化的时候， zookeeper 会产 生一个 watcher 事件，并且会发送到客户端。但是客户端 只会收到一次通知。如果后续这个节点再次发生变化，那 么之前设置 watcher 的客户端不会再次收到消息。 （watcher 是一次性的操作）。 可以通过循环监听去达到 永久监听效果 

#### 注册事件机制 

​	通过这三个操作来绑定事件 ：getData、Exists、getChildren 

​	通过这三个操作来触发监听事件：create /delete /setData 

####  watcher 事件类型 

| watcher事件类型         |      | 描述                                              |
| ----------------------- | ---- | ------------------------------------------------- |
| None (-1)               |      | 客户端链接状态发生变化的时候，会 收到 none 的事件 |
| NodeCreated (1)         |      | 创建节点的事件。 比如 zkpersis-mic                |
| NodeDeleted (2)         |      | 删除节点的事件                                    |
| NodeDataChanged (3)     |      | 节点数据发生变更                                  |
| NodeChildrenChanged (4) |      | 子节点被创建、被删除、会 发生事件触发             |

